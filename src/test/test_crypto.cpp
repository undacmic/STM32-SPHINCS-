#include <gtest/gtest.h>
#include "common/crypto.h"
#include "common/address.h"

TEST(CryptoModuleTest, MaskGenerationFunction) {
    uint8_t PK_seed[SPX_N] = {
        0x01, 0x02, 0x03, 0x04,
        0x01, 0x02, 0x03, 0x04,
        0x01, 0x02, 0x03, 0x04,
        0x01, 0x02, 0x03, 0x04
    };    
    uint8_t ADRS[ADRS_SIZE] = { 
        0x10, 0x10, 0x10, 0x10,
        0x10, 0x10, 0x10, 0x10,
        0x10, 0x10, 0x10, 0x10,
        0x10, 0x10, 0x10, 0x10
    };
    uint8_t mask[16] = { 0 };

    uint8_t expected[16] = {
        0x18, 0x22, 0x46, 0x35,
        0x09, 0x7A, 0x98, 0xEA,
        0xC3, 0x7C, 0x98, 0xC3,
        0x2D, 0xF7, 0x6D, 0x17,
        // 0xFA, 0xCF, 0xDB, 0x69,
        // 0x6C, 0xF0, 0x51, 0x1E,
        // 0xB4, 0x9F, 0x42, 0x96,
        // 0x81, 0x10, 0x93, 0x73
    };

    mgf1(mask, PK_seed, ADRS, 16);
    for (int i = 0; i < 16; i++) {
        EXPECT_EQ(expected[i], mask[i]);
    }
}

